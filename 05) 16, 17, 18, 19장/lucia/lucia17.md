# 17. 생성자 함수에 의한 객체 생성

## 17.1 Object 생성자 함수
- 생성자 함수
  - new 연산자와 함께 호출하여 객체(인스턴스)를 생성하는 함수
  - 생성자 함수에 의해 생성된 객체를 인스턴스라고 함
  - 자바스크립트에서는 String, Number, Date, RegExp 등 빌트인 생성자 함수를 제공한다

## 17.2 생성자 함수

### 17.2.1 객체 리터럴에 의한 객체 생성 방식의 문제점
- 객체 리터럴에 의한 객체 생성 방식은 단 하나의 객체만 생성
- 동일한 프로퍼티를 갖는 객체를 여러개 생성해야하는 경우 비효율적

### 17.2.2 생성자 함수에 의한 객체 생성 방식의 장점
- 객체를 생성하기 위한 템플릿처럼 생성자 함수를 사용해 프로퍼티 구조가 동일한 객체 여러개를 간편하게 생성 가능
-  this
  - 객체 자신의 프로퍼티나 메서드를 참조하기 위한 자기 참조 변수
  - 함수 호출 방시겡 따라 동적으로 결정됨
  - 일반 함수로서 호출: 전역객체
  - 메서드로서 호출: 메서드를 호출한 객체
  - 생성자 함수로서 호출: 생성자 함수가 생성할 인스턴스
- 자바스크립트에서는 일반 함수와 동일한 방법으로 생성자 함수를 정의하기 때문에 new 연산자와 함께 호출하는 경우에만 새로운 인스턴스를 생성
  - new 연산자가 없는 경우, 일반 함수로 취급

### 17.2.3 생성자 함수의 인스턴스 생성 과정
- 생성자 함수의 역할
  - 템플릿에 맞는 인스턴스 생성 (필수)
  - 생성된 인스턴스를 초기화 (옵션)
  - 암묵적으로 인스턴스를 생성하고 반환
- 인스턴스 생성과 this 바인딩
  - 암묵적으로 빈 객체가 생성된 뒤, this에 바인딩
- 인스턴스 초기화
  - 생성자 함수에 기술된 코드가 한 줄씩 실행되면, this에 바인딩 되어있는 인스턴스를 초기화
- 인스턴스 반환
  - 생성자 함수 내부의 모든 처리가 끝나면 완성된 인스턴스가 바인딩된 this가 암묵적으로 반환
  - 만약 명시적으로 다른 객체를 return 하면 this 반환이 무시되고 return한 객체가 반환됨. 따라서 생성자 함수 내부에서 return 객체를 사용하면 안됨

### 17.2.4 내부 메서드
- 함수는 객체지만 일반 객체와 다른 특징을 가짐
  - 일반 객체는 호출할 수 없지만 함수는 호출 가능
  - 일반 객체가 가지고 있는 내부 슬롯과 내부 메서드
  -  함수 객체만을 위한 내부 슬롯 ([[Environment]], [[FormalParameters]])
  -   함수 객체만을 위한 내부 메서드 ([[Call]], [[Construct]])
    - 일반 함수로서 호출 시 Call 호출
    - new 연산자와 함께 호출 시 Construct 호출
- 내부 메서드 Call을 갖는 함수 객체 = callable -> 함수
- 내부 메서드 Contruct를 갖는 함수 객체 = constructor -> 생성자 함수로서 호출할 수 있는 함수
- 함수 객체는 반드시 callable
- 모든 함수는 Call을 갖지만, Construct를 갖지 않을 수 있음
  - 생성자 함수가 될 수 있냐 없냐의 차이

### 17.2.5 constructor와 non- constructor의 구분
- constructor : 함수 선언문, 함수 표현식, 클래스
- non-constructor : 메서드, 화살표 함수
- 프로퍼티의 값으로 할당된 것은 일반함수로 정의된 함수
- 함수의 정의 방식에 따라 constructor인지 아닌지 결정됨
- non-constructor를 생성자 함수로 호출 시 TypeError 발생

### 17.2.6 new 연산자
- new 연산자와 함께 호출 : `[[construct]]` 호출
  - this == 호출한 생성자 함수가 생성할 인스턴스
- new 연산자 없이 호출 : `[[call]]` 호출
  - this == 전역 객체

### 17.2.7 new.target
- 생성자 함수가 new 연산자 없이 호출되는 것을 방지하기 위함
- this와 유사하게 constructor인 모든 함수 내부에서 암묵적인 지역변수와 같이 사용 (메타 프로퍼티)
- new 연산자와 함께 생성자 함수로서 호출되면 new.target은 자기 자신
- new 연산자와 함께 생성된 객체는 프로토타입에 의해 생성자 함수와 연결됨
- 대부분의 빌트인 생성자 함수에서는 이를 확인해 적절한 값을 반환
- String, Number와 같은 생성자 함수는 new 연산자가 없는 경우 타입 변환을 위해 사용됨
